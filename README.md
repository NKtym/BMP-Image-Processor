# BMP-Image-Processor
# Тестовое задание Эффективная мобильная  
**Версия:** 1.0  
**Название:** Консольное приложение для работы с BMP файлами

## Описание  
Данное консольное приложение предназначено для работы с BMP файлами, содержащими только два цвета:  
- **Черный:** RGB(0, 0, 0)  
- **Белый (фон):** RGB(255, 255, 255)

Приложение выполняет следующие операции:  
- Читает BMP файл (поддерживаются только 32-битные форматы, DIB 40-битный).  
- Выводит изображение в консоль, используя два разных символа для отображения черного и белого цветов.(# - для черного, . - для белого) 
- Рисует на изображении крест (Х) с помощью функции рисования линии, которая строит линию между двумя заданными точками (x1, y1) и (x2, y2).  
- Снова выводит модифицированное изображение в консоль и сохраняет его в новый BMP файл, имя которого запрашивается у пользователя.

Перед завершением работы приложение освобождает все выделенные ресурсы (например, закрывает файловые потоки).

## Технические требования  
- **Формат BMP:** Поддерживаются только BMP файлы с глубиной цвета 32 бита. Другие форматы не рассматриваются.  
- **Чтение файла:** Для чтения BMP файлов используется стандартная библиотека C++ `<fstream>`.  
- **Использование заголовочных файлов:** При необходимости можно использовать структуры из `<windows.h>` (при сборке под Windows), но желательно определить все необходимые структуры самостоятельно.  
- **Инкапсуляция:** Все данные, необходимые для открытия, отображения, сохранения изображения и рисования линии, инкапсулируются в одном классе.  
- **Принципы разработки:**  
  - **DRY:** Избегать дублирования кода.  
  - **KISS:** Приложение должно быть простым и понятным.  
  - **YAGNI:** Реализовывать только необходимый функционал.

## Структура проекта  
```
/BMP-Image-Processor
├── bin
│   └── main
├── image
│   ├── input_test.bmp
│   └── output_test.bmp
├── include
│   └── BMP.hpp
├── Makefile
├── README.md
├──.gitignore
├── script
│   └── run.sh
└── src
    ├── BMP.cpp
    └── main.cpp
```

## Сборка проекта  
Для сборки проекта используйте `Makefile`, который находится в корневой директории проекта.  
Выполните команду:  

```bash
make
```

Исполняемый файл main будет создан в папке /bin.

## Использование  
1. Перейдите в директорию с исполняемым файлом:
   ```bash
   cd bin
   ```
2. Запустите приложение:
   ```bash
   ./main
   ```
3. Приложение запросит путь к входному BMP файлу:
   ```
   >> Введите имя входного BMP-файла: ../image/input_test.bmp
   ```
4. После ввода, приложение отобразит изображение в консоли.  
5. На изображении будет нарисован крест (Х) с помощью функции рисования линии, после чего изображение снова выводится в консоль.  
6. Приложение запросит имя выходного BMP файла:
   ```
   >> Введите имя выходного BMP-файла: ../image/output_test.bmp
   ```
7. Измененное изображение будет сохранено в указанной директории.

## Скрипт
В директории `/scripts` находится скрипт `run.sh`, предназначенный для простого запуска и проверки работы. Скрипт:  
- Считывает изображение из директории `/image`.  
- Запускает приложение передавая имена входного и выходного файлов.  
- Сохраняет результат в директорию `/image`.

### Запуск скрипта  
1. Сделайте скрипт исполняемым:
   ```bash
   chmod +x run_tests.sh
   ```
2. Запустите скрипт:
   ```bash
   ./run.sh
   ```

## Управление ресурсами  
Все выделенные ресурсы (например, файловые потоки) освобождаются перед завершением работы приложения, что обеспечивает корректное закрытие и сохранение данных.
```
valgrind ./main
```

```
==17270== Memcheck, a memory error detector
==17270== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==17270== Using Valgrind-3.18.1 and LibVEX; rerun with -h for copyright info
==17270== Command: ./main
==17270== 
>> Enter input BMP file name: ../image/input_test.bmp
##........
##........
..........
..........
..........
..........
..........
..........
..........
..........

Измененное изображение (с крестом):
##.......#
##......#.
..#....#..
...#..#...
....##....
....##....
...#..#...
..#....#..
.#......#.
#........#

>> Введите имя выходного BMP файла: ../image/output_test.bmp
==17270== 
==17270== HEAP SUMMARY:
==17270==     in use at exit: 0 bytes in 0 blocks
==17270==   total heap usage: 9 allocs, 9 frees, 92,511 bytes allocated
==17270== 
==17270== All heap blocks were freed -- no leaks are possible
==17270== 
==17270== For lists of detected and suppressed errors, rerun with: -s
==17270== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)
```

## Ограничения  
- Поддерживаются только BMP файлы с глубиной цвета 32 бита, DIB формата 40 бит.  
- Приложение предназначено для работы с изображениями, содержащими только два цвета: черный и белый.  
- Изображения должны быть небольшого размера.